Экскурсия по Национальному парку

Байтленда заключается в следующем: имеются острова,
соединённые мостами. Группа собирается в начальном пункте, а затем передвигается по мостам до конечного пункта, причём каждый человек может идти по индивидуальному маршруту. Поскольку разные люди при этом осматривают различные достопримечательности, то стоимость экскурсии также отличается. По каждому из мостов принято ходить только в одном из направлений, чтобы посетители не мешали друг другу. (Экскурсионная группа выбирает направление движения по каждому мосту самостоятельно.) Известна некоторая стоимость прохождения каждого моста для одного человека, а стоимость экскурсии для человека равна сумме стоимостей по всем мостам, которые он собирается пройти. Группа является очень дисциплинированной, поэтому если кто-то попадает на остров, то он ждёт, пока не соберутся все, кто должен пройти через этот остров. Также для каждого моста известно максимальное число человек, которое он может одновременно принять по технике безопасности.

Составьте такой план экскурсии из начального пункта в

 конечный, при котором группа была бы максимальной, а общая стоимость экскурсии для всей группы — минимальной из всех возможных при данном размере группы.

Формат входных данных
В первой строке находится три целых числа, содержащих общую информацию о системе мостиков парка: n — число островов (2 ≤ n ≤ 30),
s — номер острова,
 откуда начинаются все экскурсии (1 ≤ s ≤ n), f — номер острова,
 на котором группа должна собраться после экскурсии (1 ≤ f ≤ n).
 Гарантируется, что начальный и конечный острова не совпадают.
Каждая из следующих строк содержит по четыре числа, задающих информацию о каждом мостике в парке: номера соединённых этим мостиком островов (от 1 до n), максимальное число m человек,
 которое может пройти по данному мосту (0 ≤ m ≤ 50) и стоимость c прохода (0 ≤ c ≤ 1000). Гарантируется, что между парой островов существует не более одного моста. Никакой мост не соединяет остров с самим собой.
  Все числа целые.

Формат выходных данных
Первая строка содержит максимальное число человек, которые смогут пройти по парку. Вторая строка содержит минимальную стоимость экскурсии для группы указанного в первой строке размера группы.